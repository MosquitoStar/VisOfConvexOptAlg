<!DOCTYPE html>
<html style="height: 100%">

<head>
    <meta charset="utf-8">
</head>

<body>

    <script src="d3/d3.min.js"></script> 

    <div id="canvas"></div>

    <script type="text/javascript">
        const n = 100;
        const duration = 1000;
        let time = new Date(Date.now() - duration);
    
        const random = d3.randomNormal(0, .2);
        const data = d3.range(n).map(random);
        
        const margin = {top: 20, right: 10, bottom: 20, left: 40};
        const width = 960 - margin.right - margin.left;
        const height = 150 - margin.top - margin.bottom;

        const xScale = d3.scaleTime()
        .domain([time - (n - 2) * duration, time - duration])
        .range([0, width]);

        const yScale = d3.scaleLinear()
        .range([height, 0])
        .domain([-1, 1]);

        const line = d3.line()
        .x((d, i) => xScale(time - (n - 1 - i) * duration))
        .y((d, i) => yScale(d))
        .curve(d3.curveBasis);

        const svg = d3.select("#canvas")
        .append('svg')
        .attr('width', width + margin.left + margin.right)
        .attr('height', height + margin.top + margin.bottom);

        const g = svg.append('g')
        .attr('transform', `translate(${margin.left}, ${margin.top})`);

        const xAxis = d3.axisBottom(xScale).ticks(15);
        const yAxis = d3.axisLeft(yScale).ticks(5);

        g.append('g')
        .attr('transform', 'translate(0,' + height + ')')
        .call(xAxis);

        g.append('g')
        .call(yAxis);

        const transition = d3
        .transition()
        .duration(duration)
        .ease(d3.easeLinear);

        const path = g.append('g')
        .append('path')
        .datum(data)
        .attr('d', line)
        .attr('fill', 'none')
        .attr('stroke', 'blue');

        var totalLength = path.node().getTotalLength();

        path.attr('stroke-dasharray', totalLength + ' ' + totalLength)
        .attr('stroke-dashoffset', totalLength)
        .transition(transition) 
        .attr('stroke-dashoffset', 0);
    </script>

</body>